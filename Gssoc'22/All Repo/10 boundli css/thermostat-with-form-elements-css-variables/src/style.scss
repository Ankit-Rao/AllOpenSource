@import 'compass/css3';

$fsu: 3.75;
$ff: open sans, sans-serif;
$ext-d: 6.75em;
$mid-d: 4.25em;
$int-d: 2.5em;
$mov-d: 3.5em;
$t: .3s;
$a: 19deg;
$dx: 50%*tan($a);

$track-d: 6em;
$track-w: .125em;
$track-o: .5*($ext-d - $track-d);
$track-mr: .5*$track-d - $track-w;
$track-m: radial-gradient(transparent $track-mr, 
		#000 calc(1px + #{$track-mr}));
$track-cp: polygon(50% - $dx 0, 50% 50%, 50% + $dx 0, 
									 100% 0, 100% 100%, 0 100%, 0 0);

$btn-d: .5*($mid-d - $int-d);

@import url('https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700');

@mixin sp($dim, $set: -1) {
	$off: calc(50% - .5*#{$dim});
	
	@if $set != -1 { --off: $off }
	@if $set != 0 { top: $off }
	@if $set != 1 { left: $off }
	width: $dim; height: $dim;
}

@mixin track($co: 360deg, $wk: 0) {
	width: 100%; height: 100%;
	border-radius: 50%;
	transform: rotate(.5turn);
	background: conic-gradient(#ff9e23, #ff4900 $co, transparent 0deg);
	background-color: #3a3749;
	@if $wk == 1 { -webkit-clip-path: $track-cp }
	clip-path: $track-cp;
}

body {
	overflow: hidden;
	background: #fdfdfd;
	
	*, :after, :before {
		box-sizing: inherit;
		position: absolute;
		margin: 0;
		padding: 0;
		border-radius: inherit;
		text-align: center;
		font: inherit;
		content: ''
	}
}

form {
	--ratio: calc((var(--val) - var(--min))/(var(--max) - var(--min)));
	--co: calc(#{$a} + var(--ratio)*(1turn - 2*#{$a}));
	box-sizing: border-box;
	@include sp($ext-d);
	border-radius: 50%;
  box-shadow: 0 7px 40px 11px rgba(84, 81, 97, .4), 
		inset 0 -6px 1px 2px rgba(#000, .35);
	background: #6d697f;
	font: 300 #{$fsu*1em}/1 $ff;
	
	&:before {
		@include sp($mid-d);
		box-shadow: 0 15px 35px 11px rgba(46, 44, 58, .6);
		background: #e3e4ed;
	}
}

[id='temp'] {
	&::-webkit-slider-runnable-track, 
	&::-webkit-slider-thumb, & {
		-webkit-appearance: none
	}
	
	top: $track-o; left: $track-o;
	width: $track-d; height: $track-d;
	background: none; /* fix Chrome white */
  pointer-events: none;
	
	/* track styles */
	&::-webkit-slider-runnable-track {
		@include track(var(--co), 1);
		-webkit-mask: $track-m
	}
	
	&::-moz-range-track {
		@include track();
		mask: $track-m
	}
	
	&::-moz-range-thumb { opacity: 0 }
}

label[for='temp'] {
	right: 0; bottom: 0; left: 0;
	font: 700 1rem/4 $ff;
	color: #2e2c3a;
	text-transform: uppercase;
}

output[for='temp'] {
	@include sp($int-d);
	box-shadow: 0 15px 35px 5px rgba(96, 93, 111, .3);
	background: #f8f9fa;
	line-height: $int-d;
	
	&:before {
		$u: $track-w*$fsu;
		@include sp($mov-d);
		border-radius: 0;
		transform: rotate(calc(var(--co) - .5turn)) 
			translatey(calc(#{.5*($mov-d - $track-d*$fsu)} - #{$u}));
		background: linear-gradient(90deg, 
					transparent calc(50% - 2px), #fff calc(50% - 1px), 
					#fff calc(50% + 1px), transparent calc(50% + 2px)) 
				50% #{$u}/ 100% $u no-repeat, 
			radial-gradient(rgba(255, 158, 35, .65), rgba(255, 158, 35, 0) 70%) 
				50% 0/ 100% 3*$u no-repeat;
		color: var(--c, #fff);
		text-shadow: 1px 3px 3px var(--c, #302e38);
		font: 600 1rem/ #{$mov-d} $ff;
		transition: $t;
		transition-property: color, text-shadow;
		counter-reset: temp var(--val);
		content: counter(temp);
		
		form:not(:hover) input:not(:focus) ~ & { --c: transparent }
	}
	
	&:after {
		display: inline-block;
		margin-top: -.375em;
		font-size: .675em;
		content: 'Â°'
	}
}

button {
	overflow: hidden;
	@include sp($btn-d, 1);
	left: calc(var(--off) + var(--s)*#{.5*($int-d + $btn-d)});
	border: none;
	background: none;
	color: #b9b6c8;
	border-radius: 0;
	text-indent: $btn-d;
	white-space: nowrap;
	transition: color $t;
	cursor: pointer;
	
	&:focus, &:hover {
		outline: none;
		color: coral;
	}
	
	&:after {
		@include sp(.25*$btn-d);
		border: solid 0 currentcolor;
		border-width: 3px 0 0 3px;
		transform: rotate(calc(45deg + var(--s)*90deg))
	}
}